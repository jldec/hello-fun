accelerator:
  displayName: Hello Fun
  description: Simple Hello Web app based on Spring Boot and Spring Cloud Function
  iconUrl: https://raw.githubusercontent.com/simple-starters/icons/master/icon-cloud.png
  tags:
    - Java
    - Spring
    - Function

  options:
    - name: k8sConfig
      label: Kubernetes deployment configurations
      description: Select one of deployment configuration options to include the files for that style of deployment.
      inputType: select
      choices:
        no-k8s: No Kubernetes
        k8s-resource-simple: Kubernetes deployment and service
        k8s-resource-skaffold: Kubernetes using skaffold
      required: true
      defaultValue: k8s-resource-simple

engineV2:
  type: Merge
  sources:
    - type: Chain
      transformations:
        - type: Include
          patterns: [ "**" ]
        - type: Exclude
          patterns: [ "accelerator.yaml", "README.md", "pom.xml", "kubernetes/**/*.yaml", "skaffold.yaml" ]

    - type: Chain
      transformations:
        - type: Include
          patterns: [ "README.md" ]
        - type: UseEncoding
          encoding: UTF-8
        - type: ReplaceText
          substitutions:
            - text: hello-fun template repo
              with: "#artifactId"

    - type: Chain
      condition: "#k8sConfig == 'k8s-resource-simple'"
      transformations:
        - type: Include
          patterns: [ "kubernetes/app/*.yaml" ]
        - type: UseEncoding
          encoding: UTF-8
        - type: ReplaceText
          substitutions:
            - text: hello-fun
              with: "#artifactId"

    - type: Chain
      condition: "#k8sConfig == 'k8s-resource-skaffold'"
      transformations:
        - type: Include
          patterns: [ "kubernetes/skaffold/*.yaml", "skaffold.yaml" ]
        - type: UseEncoding
          encoding: UTF-8
        - type: ReplaceText
          substitutions:
            - text: hello-fun
              with: "#artifactId"

    - type: Chain
      transformations:
        - type: Include
          patterns: [ "pom.xml" ]
        - type: UseEncoding
          encoding: UTF-8
        - type: ReplaceText
          substitutions:
            - text: hello-fun
              with: "#artifactId"
